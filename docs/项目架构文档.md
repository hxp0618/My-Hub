# My Hub é¡¹ç›®æ¶æ„æ–‡æ¡£

## é¡¹ç›®æ¦‚è¿°

My Hub æ˜¯ä¸€æ¬¾ AI å¢å¼ºçš„æµè§ˆå™¨æ‰©å±•ï¼Œç”¨äºç®¡ç†ä¹¦ç­¾å’Œæµè§ˆå†å²ã€‚æ”¯æŒ Chrome å’Œ Firefox æµè§ˆå™¨ã€‚

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- ğŸ” **ç»Ÿä¸€æœç´¢**ï¼šåŒæ—¶æœç´¢å†å²è®°å½•å’Œä¹¦ç­¾ï¼ˆåŒ…æ‹¬æ ‡ç­¾ï¼‰ï¼Œç»“æœåˆå¹¶å±•ç¤º
- ğŸ·ï¸ **æ ‡ç­¾ç³»ç»Ÿ**ï¼šä¸ºä¹¦ç­¾æ·»åŠ è‡ªå®šä¹‰æ ‡ç­¾ï¼Œæ”¯æŒæ ‡ç­¾æœç´¢å’Œç­›é€‰
- ğŸ¤– **AI è‡ªåŠ¨æ•´ç†**ï¼šè°ƒç”¨æœ¬åœ° Gemini Nano æˆ–äº‘ç«¯ LLMï¼Œæ™ºèƒ½æ•´ç†ä¹¦ç­¾æ–‡ä»¶å¤¹ç»“æ„
- ğŸ“Š **å†å²å¢å¼º**ï¼šæ—¶é—´åˆ†ç»„ã€æ—¥æœŸå¯¼èˆªã€æ‰¹é‡åˆ é™¤ã€å¯¼å‡ºï¼ˆCSV/HTMLï¼‰
- âš™ï¸ **æ–°æ ‡ç­¾é¡µ**ï¼šè¦†ç›–æµè§ˆå™¨æ–°æ ‡ç­¾é¡µï¼Œè‡ªå®šä¹‰æ˜¾ç¤ºä¸»é¡µ/å†å²/ä¹¦ç­¾/è®¾ç½®

**æŠ€æœ¯æ ˆï¼š**
- æ„å»ºå·¥å…·ï¼šVite 6 + @crxjs/vite-plugin
- å‰ç«¯æ¡†æ¶ï¼šReact 19 + TypeScript 5 + Tailwind CSS 4
- æµè§ˆå™¨ APIï¼šchrome.bookmarksã€chrome.historyã€chrome.sessions
- æ•°æ®å­˜å‚¨ï¼šIndexedDBï¼ˆæ ‡ç­¾æ•°æ®ï¼‰ã€localStorageï¼ˆLLM è®¾ç½®ï¼‰

## å¼€å‘å‘½ä»¤

```bash
# å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
npm run dev              # Chrome å¼€å‘æ¨¡å¼
npm run dev:firefox      # Firefox å¼€å‘æ¨¡å¼

# ç”Ÿäº§æ„å»º
npm run build            # Chrome æ„å»ºï¼ˆé»˜è®¤ï¼‰
npm run build:chrome     # Chrome æ„å»º â†’ dist_chrome/
npm run build:firefox    # Firefox æ„å»º â†’ dist_firefox/

# ä»£ç æ£€æŸ¥
npx eslint src/          # è¿è¡Œ ESLint æ£€æŸ¥æºä»£ç 
```

**åŠ è½½åˆ°æµè§ˆå™¨ï¼š**
1. Chromeï¼šæ‰“å¼€ `chrome://extensions`ï¼Œå¯ç”¨"å¼€å‘è€…æ¨¡å¼"ï¼Œç‚¹å‡»"åŠ è½½å·²è§£å‹çš„æ‰©å±•"ï¼Œé€‰æ‹© `dist_chrome/` ç›®å½•
2. Firefoxï¼šæ‰“å¼€ `about:debugging#/runtime/this-firefox`ï¼Œç‚¹å‡»"ä¸´æ—¶åŠ è½½é™„åŠ ç»„ä»¶"ï¼Œé€‰æ‹© `dist_firefox/manifest.json`

## ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ pages/                    # æ‰©å±•é¡µé¢
â”‚   â”œâ”€â”€ newtab/              # æ–°æ ‡ç­¾é¡µï¼ˆä¸»é¡µ/å†å²/ä¹¦ç­¾/è®¾ç½®ï¼‰
â”‚   â”œâ”€â”€ popup/               # å¿«æ·æ·»åŠ ä¹¦ç­¾å¼¹çª—
â”‚   â”œâ”€â”€ options/             # æ‰©å±•è®¾ç½®é¡µ
â”‚   â”œâ”€â”€ background/          # åå°è„šæœ¬ï¼ˆäº‹ä»¶ç›‘å¬å’Œæ•°æ®åŒæ­¥ï¼‰
â”‚   â”œâ”€â”€ content/             # å†…å®¹è„šæœ¬
â”‚   â”œâ”€â”€ devtools/            # å¼€å‘è€…å·¥å…·é›†æˆ
â”‚   â””â”€â”€ panel/               # ä¾§è¾¹æ é¢æ¿
â”œâ”€â”€ components/              # é€šç”¨ UI ç»„ä»¶
â”‚   â”œâ”€â”€ UnifiedSearchBar.tsx      # ç»Ÿä¸€æœç´¢æ¡†
â”‚   â”œâ”€â”€ BookmarkTree.tsx          # ä¹¦ç­¾æ ‘ç»„ä»¶
â”‚   â”œâ”€â”€ TagInput.tsx              # æ ‡ç­¾è¾“å…¥ç»„ä»¶
â”‚   â”œâ”€â”€ SelectionActionBar.tsx    # æ‰¹é‡æ“ä½œå·¥å…·æ 
â”‚   â”œâ”€â”€ DateNavigator.tsx         # æ—¥æœŸå¯¼èˆªå™¨
â”‚   â””â”€â”€ OrganizeBookmarksModal.tsx # AI æ•´ç†å¼¹çª—
â”œâ”€â”€ hooks/                   # React Hooks
â”‚   â””â”€â”€ useGlobalSearch.ts   # å…¨å±€æœç´¢ Hook
â”œâ”€â”€ services/                # ä¸šåŠ¡æœåŠ¡
â”‚   â””â”€â”€ llmService.ts        # LLM æœåŠ¡ï¼ˆæœ¬åœ°/äº‘ç«¯ï¼‰
â”œâ”€â”€ lib/                     # å·¥å…·å‡½æ•°å’Œæç¤ºè¯
â”‚   â”œâ”€â”€ llmUtils.ts          # LLM å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ bookmarkOrganizePrompts.ts      # ä¹¦ç­¾æ•´ç†æç¤ºè¯
â”‚   â”œâ”€â”€ tagGenerationPrompts.ts         # æ ‡ç­¾ç”Ÿæˆæç¤ºè¯
â”‚   â”œâ”€â”€ bookmarkSuggestionPrompts.ts    # ä¹¦ç­¾æ¨èæç¤ºè¯
â”‚   â””â”€â”€ bookmarkExport.ts    # ä¹¦ç­¾å¯¼å‡ºåŠŸèƒ½
â”œâ”€â”€ db/                      # æ•°æ®åº“æ“ä½œ
â”‚   â””â”€â”€ indexedDB.ts         # IndexedDB å°è£…
â”œâ”€â”€ data/                    # æ•°æ®å’Œé…ç½®
â”‚   â””â”€â”€ models.ts            # LLM æœåŠ¡å•†å’Œæ¨¡å‹é…ç½®
â””â”€â”€ types/                   # TypeScript ç±»å‹å®šä¹‰
    â”œâ”€â”€ bookmarks.ts
    â”œâ”€â”€ search.ts
    â””â”€â”€ llm.ts
```

## æ ¸å¿ƒæ¶æ„

### 1. å¤šé¡µé¢æ‰©å±•æ¶æ„

æ‰©å±•ç”±å¤šä¸ªç‹¬ç«‹é¡µé¢ç»„æˆï¼Œæ¯ä¸ªé¡µé¢æœ‰ç‰¹å®šç”¨é€”ï¼š

- **newtabï¼ˆæ–°æ ‡ç­¾é¡µï¼‰**ï¼šä¸»ç•Œé¢ï¼ŒåŒ…å«å››ä¸ªæ ‡ç­¾é¡µ
  - é¦–é¡µï¼šç»Ÿä¸€æœç´¢å…¥å£
  - å†å²ï¼šå†å²è®°å½•ç®¡ç†
  - ä¹¦ç­¾ï¼šä¹¦ç­¾å’Œæ ‡ç­¾ç®¡ç†
  - è®¾ç½®ï¼šLLM é…ç½®å’Œæ‰©å±•è®¾ç½®

- **popupï¼ˆå¼¹çª—ï¼‰**ï¼šç‚¹å‡»æ‰©å±•å›¾æ ‡æ—¶å¼¹å‡ºï¼Œç”¨äºå¿«é€Ÿæ·»åŠ ä¹¦ç­¾

- **backgroundï¼ˆåå°ï¼‰**ï¼šè¿è¡Œåœ¨åå°çš„æœåŠ¡
  - Chromeï¼šä½¿ç”¨ Service Workerï¼ˆMV3ï¼‰
  - Firefoxï¼šä½¿ç”¨è„šæœ¬åå°

- **optionsï¼ˆè®¾ç½®é¡µï¼‰**ï¼šå³é”®æ‰©å±•å›¾æ ‡ â†’ "é€‰é¡¹"æ‰“å¼€çš„ç‹¬ç«‹è®¾ç½®é¡µ

### 2. æ•°æ®å­˜å‚¨æ¶æ„

é¡¹ç›®é‡‡ç”¨**åŒå­˜å‚¨ç³»ç»Ÿ**ï¼š

#### Chrome åŸç”Ÿ API
- `chrome.bookmarks`ï¼šç®¡ç†ä¹¦ç­¾å’Œæ–‡ä»¶å¤¹
- `chrome.history`ï¼šè®¿é—®æµè§ˆå†å²
- `chrome.sessions`ï¼šè·¨è®¾å¤‡ä¼šè¯ä¿¡æ¯

#### IndexedDBï¼ˆè‡ªå®šä¹‰æ ‡ç­¾ç³»ç»Ÿï¼‰
```javascript
æ•°æ®åº“åç§°ï¼šChromeHistoryDB
å¯¹è±¡å­˜å‚¨ï¼šbookmark_tags
ä¸»é”®ï¼šurlï¼ˆå­—ç¬¦ä¸²ï¼‰
æ•°æ®ç»“æ„ï¼š{ url: string, tags: string[] }
```

**ä¸ºä»€ä¹ˆç”¨ URL ä½œä¸ºä¸»é”®ï¼Ÿ**
- ä¹¦ç­¾ ID åœ¨ä¸åŒæµè§ˆå™¨é—´ä¸åŒæ­¥
- URL æ˜¯ä¹¦ç­¾çš„å”¯ä¸€æ ‡è¯†ï¼Œé€‚åˆä½œä¸ºæ ‡ç­¾æ•°æ®çš„å…³è”é”®

**æ“ä½œæ¥å£**ï¼ˆ`src/db/indexedDB.ts`ï¼‰ï¼š
- `addBookmarkTag(bookmarkTag)` - æ·»åŠ /æ›´æ–°æ ‡ç­¾
- `getBookmarkTag(url)` - è·å–æŒ‡å®š URL çš„æ ‡ç­¾
- `getAllBookmarkTags()` - è·å–æ‰€æœ‰æ ‡ç­¾
- `deleteBookmarkTag(url)` - åˆ é™¤æŒ‡å®š URL çš„æ ‡ç­¾
- `deleteMultipleBookmarkTags(urls)` - æ‰¹é‡åˆ é™¤æ ‡ç­¾
- `batchUpdateTags(updates)` - æ‰¹é‡æ›´æ–°æ ‡ç­¾
- `clearAllBookmarkTags()` - æ¸…ç©ºæ‰€æœ‰æ ‡ç­¾

### 3. åå°åŒæ­¥æœºåˆ¶

**èƒŒæ™¯é—®é¢˜ï¼š**
- ä¹¦ç­¾ API ä½¿ç”¨ ID æ ‡è¯†ä¹¦ç­¾
- æ ‡ç­¾ç³»ç»Ÿä½¿ç”¨ URL æ ‡è¯†ä¹¦ç­¾
- éœ€è¦ç»´æŠ¤ ID â†” URL çš„æ˜ å°„å…³ç³»

**è§£å†³æ–¹æ¡ˆ**ï¼ˆ`src/pages/background/index.ts`ï¼‰ï¼š

```javascript
// å†…å­˜æ˜ å°„è¡¨ï¼šid â†’ url
const bookmarkIdToUrlMap = new Map<string, string>()

// å¯åŠ¨æ—¶æ„å»ºå®Œæ•´æ˜ å°„
initializeMapping() // éå†æ•´ä¸ªä¹¦ç­¾æ ‘

// ç›‘å¬ä¹¦ç­¾äº‹ä»¶
chrome.bookmarks.onCreated    // æ·»åŠ åˆ°æ˜ å°„
chrome.bookmarks.onRemoved    // ä»æ˜ å°„å’Œ IndexedDB åˆ é™¤
chrome.bookmarks.onChanged    // URL å˜æ›´æ—¶è¿ç§»æ ‡ç­¾æ•°æ®
```

**ç‰¹æ®Šå¤„ç†ï¼š**
- **æ–‡ä»¶å¤¹åˆ é™¤**ï¼šé€’å½’åˆ é™¤æ–‡ä»¶å¤¹å†…æ‰€æœ‰ä¹¦ç­¾çš„æ ‡ç­¾æ•°æ®
- **URL å˜æ›´**ï¼šä»æ—§ URL è¯»å–æ ‡ç­¾ï¼Œåˆ é™¤æ—§è®°å½•ï¼Œç”¨æ–° URL åˆ›å»ºè®°å½•

### 4. LLM é›†æˆæ¶æ„

**è®¾è®¡ç†å¿µï¼šæœ¬åœ°ä¼˜å…ˆï¼Œäº‘ç«¯å¤‡ç”¨**

#### æœåŠ¡å±‚ï¼ˆ`src/services/llmService.ts`ï¼‰

ç»Ÿä¸€çš„ `sendMessage` å‡½æ•°ï¼Œæ”¯æŒä¸¤ç§æ¨¡å¼ï¼š

```typescript
sendMessage(messages, callbacks, abortSignal, { stream: true/false })
```

**æ‰§è¡Œæµç¨‹ï¼š**
1. æ£€æŸ¥æ˜¯å¦å¯ç”¨ `prioritizeGeminiNano`
2. å¦‚æœå¯ç”¨ï¼Œå°è¯•æœ¬åœ° Gemini Nanoï¼ˆPrompt APIï¼‰
3. å¦‚æœå¤±è´¥æˆ–æœªå¯ç”¨ï¼Œå›é€€åˆ°äº‘ç«¯ LLM
4. æ ¹æ® `stream` å‚æ•°é€‰æ‹©æµå¼/éæµå¼å“åº”

**ä¸¤ç§å“åº”æ¨¡å¼ï¼š**
- **æµå¼ï¼ˆstream: trueï¼‰**ï¼šç”¨äº UI å®æ—¶æ›´æ–°ï¼Œé€å­—æ˜¾ç¤º AI å›å¤
- **éæµå¼ï¼ˆstream: falseï¼‰**ï¼šç”¨äºéœ€è¦è§£æ JSON çš„åœºæ™¯ï¼ˆå¦‚è‡ªåŠ¨æ•´ç†ä¹¦ç­¾ï¼‰

#### é…ç½®ç®¡ç†

**æœåŠ¡å•†é…ç½®**ï¼ˆ`src/data/models.ts`ï¼‰ï¼š
```typescript
PROVIDERS = {
  siliconflow: { baseUrl: '...', models: [...] },
  openrouter: { baseUrl: '...', models: [...] },
  custom: { /* ç”¨æˆ·è‡ªå®šä¹‰ */ }
}
```

**è®¾ç½®å­˜å‚¨**ï¼ˆlocalStorageï¼‰ï¼š
```javascript
{
  selectedProvider: 'siliconflow' | 'openrouter' | 'custom',
  apiKey: string,
  selectedModel: string,
  customApiUrl?: string,
  customModel?: string,
  prioritizeGeminiNano: boolean
}
```

#### æç¤ºè¯ç®¡ç†

ä¸åŒåŠŸèƒ½ä½¿ç”¨ä¸åŒçš„æç¤ºè¯æ¨¡æ¿ï¼š
- `bookmarkOrganizePrompts.ts` - ä¹¦ç­¾æ•´ç†æç¤ºè¯
- `tagGenerationPrompts.ts` - æ ‡ç­¾ç”Ÿæˆæç¤ºè¯
- `bookmarkSuggestionPrompts.ts` - ä¹¦ç­¾æ¨èæç¤ºè¯

### 5. å…¨å±€æœç´¢å®ç°

**Hookï¼š`src/hooks/useGlobalSearch.ts`**

**æœç´¢ç­–ç•¥ï¼š**
```javascript
// å¹¶è¡Œæ‰§è¡Œä¸¤ä¸ªæœç´¢
Promise.all([
  chrome.history.search({ text: searchTerm }),  // æœç´¢å†å²
  æœç´¢æœ¬åœ°ä¹¦ç­¾ï¼ˆtitle/url/tags åŒ¹é…ï¼‰            // æœç´¢ä¹¦ç­¾
])
```

**æ€§èƒ½ä¼˜åŒ–ï¼š**
- 300ms é˜²æŠ–ï¼ˆé¿å…é¢‘ç¹æœç´¢ï¼‰
- å†å²è®°å½•é™åˆ¶ 100 æ¡
- ä¹¦ç­¾åœ¨å†…å­˜ä¸­æœç´¢ï¼ˆå¿«é€Ÿï¼‰

**æœç´¢èŒƒå›´ï¼š**
- å†å²è®°å½•ï¼šæ ‡é¢˜ã€URL
- ä¹¦ç­¾ï¼šæ ‡é¢˜ã€URLã€**æ ‡ç­¾**ï¼ˆè¿™æ˜¯å…³é”®å·®å¼‚åŒ–åŠŸèƒ½ï¼‰

### 6. æ„å»ºé…ç½®æ¶æ„

**ä¸‰å±‚é…ç½®ç»“æ„ï¼š**

1. **vite.config.base.ts** - åŸºç¡€é…ç½®
   - React + Tailwind + TypeScript
   - è·¯å¾„åˆ«åï¼ˆ@src/*, @assets/*, @locales/*, @pages/*ï¼‰
   - å›½é™…åŒ–å¼€å…³ï¼ˆ`localize` æ ‡å¿—ï¼‰

2. **vite.config.chrome.ts** - Chrome ä¸“ç”¨
   - ä½¿ç”¨ Service Workerï¼ˆMV3ï¼‰
   - è¾“å‡ºåˆ° `dist_chrome/`

3. **vite.config.firefox.ts** - Firefox ä¸“ç”¨
   - ä½¿ç”¨è„šæœ¬åå°
   - è¾“å‡ºåˆ° `dist_firefox/`

**è·¯å¾„åˆ«åé…ç½®**ï¼ˆ`tsconfig.json`ï¼‰ï¼š
```json
{
  "baseUrl": ".",
  "paths": {
    "@src/*": ["src/*"],
    "@assets/*": ["src/assets/*"],
    "@locales/*": ["src/locales/*"],
    "@pages/*": ["src/pages/*"]
  }
}
```

## å…³é”®æŠ€æœ¯ç»†èŠ‚

### IndexedDB æ ‡ç­¾ç®¡ç†

**è®¾è®¡å†³ç­–ï¼š**
- âœ… ä½¿ç”¨ URL ä½œä¸ºä¸»é”®ï¼ˆè€Œéä¹¦ç­¾ IDï¼‰
- âœ… äº‹åŠ¡æ‰¹é‡æ“ä½œï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰
- âœ… åå°è„šæœ¬ç›‘å¬ä¹¦ç­¾äº‹ä»¶è‡ªåŠ¨åŒæ­¥

**æ‰¹é‡æ“ä½œç¤ºä¾‹ï¼š**
```typescript
// æ‰¹é‡æ›´æ–°æ ‡ç­¾
batchUpdateTags([
  { url: 'https://example.com', tags: ['tech', 'frontend'] },
  { url: 'https://another.com', tags: ['news'] }
])

// æ‰¹é‡åˆ é™¤ï¼ˆåˆ é™¤æ–‡ä»¶å¤¹æ—¶ä½¿ç”¨ï¼‰
deleteMultipleBookmarkTags([
  'https://example1.com',
  'https://example2.com'
])
```

### åå°è„šæœ¬æ³¨æ„äº‹é¡¹

**Chrome Service Workerï¼ˆMV3ï¼‰ï¼š**
- éæŒä¹…åŒ–è¿è¡Œï¼Œå¯èƒ½éšæ—¶è¢«ç»ˆæ­¢
- å†…å­˜æ•°æ®ï¼ˆå¦‚ `bookmarkIdToUrlMap`ï¼‰ä¼šåœ¨é‡å¯åä¸¢å¤±
- æ¯æ¬¡å¯åŠ¨éœ€è¦é‡æ–°æ„å»ºæ˜ å°„è¡¨

**Firefox è„šæœ¬åå°ï¼š**
- ç”Ÿå‘½å‘¨æœŸä¸åŒäº Chrome
- å…¼å®¹æ€§æµ‹è¯•åº”ä¼˜å…ˆåœ¨ Chrome å®Œæˆ

### LLM é”™è¯¯å¤„ç†

**è‡ªåŠ¨å›é€€æœºåˆ¶ï¼š**
```javascript
try {
  await tryGeminiNano()  // å°è¯•æœ¬åœ°
} catch (error) {
  // è‡ªåŠ¨å›é€€åˆ°äº‘ç«¯ LLM
  console.warn('Gemini Nano ä¸å¯ç”¨ï¼Œå›é€€åˆ°äº‘ç«¯')
}
```

**ç”¨æˆ·å¯æ„ŸçŸ¥çš„é”™è¯¯ï¼š**
- API Key é”™è¯¯
- ç½‘ç»œè¿æ¥å¤±è´¥
- æ¨¡å‹ä¸æ”¯æŒ

**é™é»˜å¤„ç†çš„é”™è¯¯ï¼š**
- Gemini Nano ä¸å¯ç”¨ï¼ˆè‡ªåŠ¨å›é€€ï¼‰
- ç”¨æˆ·å–æ¶ˆè¯·æ±‚ï¼ˆAbortSignalï¼‰

## ä»£ç è§„èŒƒ

### TypeScript è¦æ±‚

- âœ… å¼€å¯ä¸¥æ ¼æ¨¡å¼ï¼ˆ`strict: true`ï¼‰
- âŒ é¿å…ä½¿ç”¨ `any` ç±»å‹
- âœ… ä¼˜å…ˆä½¿ç”¨ æ—©è¿”å›ï¼ˆearly returnï¼‰å‡å°‘åµŒå¥—
- âœ… ä¸ºæ‰€æœ‰å‡½æ•°å‚æ•°å’Œè¿”å›å€¼æ·»åŠ ç±»å‹æ³¨è§£

### React ç¼–ç è§„èŒƒ

- âœ… React 19 ä¸éœ€è¦å¯¼å…¥ `React`ï¼ˆJSX è‡ªåŠ¨å¤„ç†ï¼‰
- âœ… è‡ªå®šä¹‰ Hook æ”¾åœ¨ `src/hooks/`
- âœ… é€šç”¨ç»„ä»¶æ”¾åœ¨ `src/components/`
- âœ… é¡µé¢ç‰¹å®šç»„ä»¶æ”¾åœ¨å¯¹åº”é¡µé¢çš„ `components/` å­ç›®å½•

### ESLint é…ç½®

åŸºäºä»¥ä¸‹è§„åˆ™ï¼š
- `eslint:recommended`
- `plugin:react/recommended`
- `plugin:@typescript-eslint/recommended`

ç‰¹æ®Šé…ç½®ï¼š
- `chrome` å…¨å±€å˜é‡åªè¯»
- ç¦ç”¨ `react/react-in-jsx-scope`ï¼ˆReact 19 ä¸éœ€è¦ï¼‰

## å¸¸è§å¼€å‘ä»»åŠ¡

### æ·»åŠ æ–°çš„ LLM æœåŠ¡å•†

1. åœ¨ `src/data/models.ts` çš„ `PROVIDERS` ä¸­æ·»åŠ é…ç½®
2. ç¡®ä¿ API æ ¼å¼å…¼å®¹ OpenAI æ ‡å‡†ï¼ˆæˆ–è°ƒæ•´ `llmService.ts`ï¼‰

### æ·»åŠ æ–°çš„ä¹¦ç­¾æ“ä½œ

1. åœ¨ `src/db/indexedDB.ts` æ·»åŠ  IndexedDB æ“ä½œå‡½æ•°
2. åœ¨ `src/pages/background/index.ts` æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼ˆå¦‚æœéœ€è¦ï¼‰
3. åœ¨å¯¹åº”çš„é¡µé¢ç»„ä»¶ä¸­è°ƒç”¨

### ä¿®æ”¹æœç´¢é€»è¾‘

ç¼–è¾‘ `src/hooks/useGlobalSearch.ts`ï¼š
- è°ƒæ•´é˜²æŠ–æ—¶é—´ï¼ˆ`SEARCH_DEBOUNCE_TIME`ï¼‰
- ä¿®æ”¹æœç´¢åŒ¹é…é€»è¾‘
- è°ƒæ•´ç»“æœæ’åºç®—æ³•

### å¯ç”¨å›½é™…åŒ–

1. åœ¨ `vite.config.base.ts` è®¾ç½® `localize = true`
2. åœ¨ `src/locales/` æ·»åŠ è¯­è¨€æ–‡ä»¶
3. åœ¨ `manifest.json` ä½¿ç”¨ `__MSG_xxx__` å ä½ç¬¦

## è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹åå°è„šæœ¬æ—¥å¿—

- Chromeï¼š`chrome://extensions` â†’ æ‰¾åˆ°æ‰©å±• â†’ "æŸ¥çœ‹è§†å›¾ï¼šService Worker"
- Firefoxï¼š`about:debugging` â†’ "æ­¤ Firefox" â†’ æ‰¾åˆ°æ‰©å±• â†’ "æ£€æŸ¥"

### æŸ¥çœ‹ IndexedDB æ•°æ®

1. æ‰“å¼€æ‰©å±•é¡µé¢ï¼ˆå¦‚æ–°æ ‡ç­¾é¡µï¼‰
2. F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
3. Applicationï¼ˆåº”ç”¨ï¼‰â†’ IndexedDB â†’ ChromeHistoryDB â†’ bookmark_tags

### æµ‹è¯• LLM è¿æ¥

è®¾ç½®é¡µé¢æä¾›"æµ‹è¯•è¿æ¥"æŒ‰é’®ï¼Œå¯éªŒè¯ï¼š
- API Key æ˜¯å¦æœ‰æ•ˆ
- Base URL æ˜¯å¦æ­£ç¡®
- æ¨¡å‹æ˜¯å¦å¯ç”¨

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **æœç´¢ä¼˜åŒ–**ï¼šä½¿ç”¨ Web Worker å¤„ç†å¤§é‡ä¹¦ç­¾æœç´¢
2. **è™šæ‹Ÿæ»šåŠ¨**ï¼šä¹¦ç­¾åˆ—è¡¨è¶…è¿‡ 1000 æ¡æ—¶ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
3. **å»¶è¿ŸåŠ è½½**ï¼šå†å²è®°å½•é‡‡ç”¨æ— é™æ»šåŠ¨åŠ è½½
4. **ç¼“å­˜ç­–ç•¥**ï¼šç¼“å­˜å¸¸ç”¨çš„ä¹¦ç­¾æ ‘ç»“æ„

## å¸¸è§é—®é¢˜

### Gemini Nano æç¤ºä¸å¯ç”¨

æ£€æŸ¥ Chrome ç‰ˆæœ¬æ˜¯å¦æ”¯æŒ Prompt APIï¼š
```javascript
if (typeof LanguageModel !== 'undefined') {
  const availability = await LanguageModel.availability()
  console.log(availability) // 'available' | 'not-available' | 'after-download'
}
```

### æ ‡ç­¾æ•°æ®ä¸¢å¤±

å¯èƒ½åŸå› ï¼š
1. ä¹¦ç­¾ URL å‘ç”Ÿå˜åŒ–ï¼ˆåº”è¯¥ä¼šè‡ªåŠ¨è¿ç§»ï¼Œæ£€æŸ¥åå°æ—¥å¿—ï¼‰
2. IndexedDB è¢«æ¸…ç†ï¼ˆæµè§ˆå™¨è®¾ç½®æˆ–éšç§æ¨¡å¼ï¼‰
3. åå°è„šæœ¬äº‹ä»¶ç›‘å¬å™¨æœªæ­£ç¡®æ³¨å†Œ

### Firefox å…¼å®¹æ€§é—®é¢˜

- ä¼˜å…ˆåœ¨ Chrome éªŒè¯åŠŸèƒ½é€»è¾‘
- Firefox çš„ MV3 æ”¯æŒå¯èƒ½æœ‰å·®å¼‚
- æ£€æŸ¥ `vite.config.firefox.ts` çš„ç‰¹æ®Šé…ç½®

## è´¡çŒ®æŒ‡å—

æäº¤ä»£ç å‰ï¼š
1. è¿è¡Œ `npx eslint src/` ç¡®ä¿æ²¡æœ‰ lint é”™è¯¯
2. æµ‹è¯• Chrome å’Œ Firefox ä¸¤ä¸ªæµè§ˆå™¨
3. ä¿æŒä»£ç é£æ ¼ä¸ç°æœ‰ä»£ç ä¸€è‡´
4. ä¸ºæ–°åŠŸèƒ½æ·»åŠ å¿…è¦çš„ç±»å‹å®šä¹‰

## å‚è€ƒèµ„æ–™

- [Chrome Extension API æ–‡æ¡£](https://developer.chrome.com/docs/extensions/reference/)
- [Vite å®˜æ–¹æ–‡æ¡£](https://vitejs.dev/)
- [React 19 æ–‡æ¡£](https://react.dev/)
- [Tailwind CSS 4 æ–‡æ¡£](https://tailwindcss.com/)
